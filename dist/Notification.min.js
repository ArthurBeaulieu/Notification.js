"use strict";class Notification{constructor(a){return!Notification.instance?(Notification.instance=this,this._dismissAllLock=!1,this._dom={},this._active={},this._queue={},this._default={},this._position="",this._thickBorder="",this._duration=0,this._transition=0,this._maxActive=0,this._init(a),this._attach(),this):Notification.instance}_init(a){a===void 0&&(a={}),this._dom=document.createElement("DIV"),this._dom.classList.add("notification-container"),this._default={handler:{position:"top-right",thickBorder:"top",duration:5e3,transition:200,maxActive:10},notification:{type:"info",message:"",title:"",iconless:!1,closable:!0,sticky:!1,renderTo:this._dom,CBtitle:"",callback:null},color:{success:"rgb(76, 175, 80)",info:"rgb(3, 169, 244)",warning:"rgb(255, 152, 0)",error:"rgb(244, 67, 54)"}},this._setOptionsDefault(a),this._position=a.position,this._thickBorder=a.thickBorder,this._duration=a.duration,this._transition=a.transition,this._maxActive=a.maxActive,this._setAttributesDefault(),this._dom.classList.add(this._position)}_setOptionsDefault(a){a.position===void 0&&(a.position=this._default.handler.position),a.thickBorder===void 0&&(a.thickBorder=this._default.handler.thickBorder),a.duration===void 0&&(a.duration=this._default.handler.duration),a.transition&&(a.transition=this._default.handler.transition),a.maxActive&&(a.maxActive=this._default.handler.maxActive)}_setAttributesDefault(){"top-left"!==this._position&&"top-right"!==this._position&&"bottom-left"!==this._position&&"bottom-right"!==this._position&&(this._position=this._default.handler.position),"top"!==this._thickBorder&&"bottom"!==this._thickBorder&&"left"!==this._thickBorder&&"right"!==this._thickBorder&&"none"!==this._thickBorder&&(this._thickBorder=this._default.handler.thickBorder),("number"!=typeof this._duration||0>=this._duration)&&(this._duration=this._default.handler.duration),this._duration<2*this._transition&&(this._transition=this._default.handler.transition),("number"!=typeof this._maxActive||0>=this._maxActive)&&(this._maxActive=this._default.handler.maxActive)}_attach(){const a=document.createDocumentFragment();a.appendChild(this._dom),document.body.appendChild(a)}_events(a){let b=!1;const c=()=>{a.isDimmed&&this._unDim(a)},d=()=>{void 0===this._active[a.id]||(1<a.requestCount?this._decrementRequestCounter(a,!0):!b&&(b=!0,window.clearTimeout(a.timeoutID),a.dom.close.removeEventListener("click",d),this._close(a)))},e=()=>{void 0!==this._active[a.id]&&(b||a.isDimmed||this._resetTimeout(a))};a.sticky&&(a.dom.addEventListener("mouseenter",c.bind(this)),a.dom.addEventListener("mouseout",c.bind(this))),a.closable&&(a.dom.addEventListener("click",d.bind(this)),a.dom.close.addEventListener("click",d.bind(this))),a.dom.addEventListener("mouseover",e.bind(this))}_buildUI(a){if(a.requestCount=1,a.totalRequestCount=1,this._buildUIDom(a),this._buildNotificationType(a),a.iconless&&a.dom.message.classList.add("iconless-width"),a.dom.text.appendChild(a.dom.maintitle),a.dom.text.appendChild(a.dom.message),a.callback){const b=document.createElement("BUTTON");b.innerHTML=a.CBtitle,a.dom.text.appendChild(b),b.addEventListener("click",()=>{this._close(a),a.callback()})}return a.iconless||a.dom.appendChild(a.dom.icon),a.dom.appendChild(a.dom.text),a.closable&&a.dom.appendChild(a.dom.close),a}_buildUIDom(a){a.dom=document.createElement("DIV"),a.dom.icon=document.createElement("IMG"),a.dom.text=document.createElement("DIV"),a.dom.close=document.createElement("DIV"),a.dom.maintitle=document.createElement("H6"),a.dom.message=document.createElement("P"),a.dom.classList.add("notification"),a.dom.icon.classList.add("vector-container"),a.dom.text.classList.add("text-container"),a.dom.close.classList.add("close"),"top"===a.thickBorder?a.dom.classList.add("top-border"):"bottom"===a.thickBorder?a.dom.classList.add("bottom-border"):"left"===a.thickBorder?a.dom.classList.add("left-border"):"right"===a.thickBorder&&a.dom.classList.add("right-border"),a.dom.maintitle.innerHTML=a.title,a.dom.message.innerHTML=a.message,a.dom.close.innerHTML="&#x2716;"}_buildNotificationType(a){"success"===a.type||"warning"===a.type||"error"===a.type||"info"===a.type?(a.dom.classList.add(a.type),!a.iconless&&(a.dom.icon.src=`./assets/${a.type}.svg`)):(a.dom.classList.add("info"),!a.iconless&&(a.dom.icon.src="./assets/info.svg"))}_start(a){Object.keys(this._active).length>=this._maxActive?this._queue[a.id]=a:(this._active[a.id]=a,this._events(a),this._open(a),a.timeoutID=window.setTimeout(()=>{this._checkCounter(a)},a.duration))}_open(a){"bottom-right"===this._position||"bottom-left"===this._position?a.renderTo.insertBefore(a.dom,a.renderTo.firstChild):a.renderTo.appendChild(a.dom),a.opened=Date.now(),window.setTimeout(()=>{a.dom.style.opacity=1},10)}_close(a){a.isClosing||(a.isClosing=!0,a.closed=Date.now(),a.effectiveDuration=a.closed-a.opened,a.dom.style.opacity=0,window.setTimeout(()=>{a.renderTo.removeChild(a.dom),delete this._active[a.id],0<Object.keys(this._queue).length?(this._start(this._queue[Object.keys(this._queue)[0]]),delete this._queue[Object.keys(this._queue)[0]]):0===Object.keys(this._active).length&&(this._dismissAllLock=!1)},1e3))}_incrementRequestCounter(a){++a.requestCount,a.totalRequestCount<a.requestCount&&(a.totalRequestCount=a.requestCount),1<a.requestCount&&(a.dom.counter?a.dom.counter.innerHTML=a.requestCount:(a.dom.counter=document.createElement("DIV"),a.dom.counter.classList.add("counter"),a.dom.counter.innerHTML=a.requestCount,a.dom.appendChild(a.dom.counter))),a.sticky&&a.isDimmed&&this._unDim(a)}_decrementRequestCounter(a,b){return a.sticky&&!b?void(a.isDimmed||this._dim(a)):void(this._resetTimeout(a),--a.requestCount,1<a.requestCount?a.dom.counter.innerHTML=a.requestCount:(a.dom.removeChild(a.dom.counter),delete a.dom.counter))}_checkCounter(a){1<a.requestCount?this._decrementRequestCounter(a):a.renderTo.contains(a.dom)&&(window.clearTimeout(a.timeoutID),a.sticky?this._dim(a):this._close(a))}_clearRequestCount(a){a.requestCount=1,a.dom.removeChild(a.dom.counter),delete a.dom.counter}_resetTimeout(a){window.clearTimeout(a.timeoutID),a.timeoutID=window.setTimeout(()=>{this._checkCounter(a)},a.duration)}_dim(a){const b=this;let c=100;(function d(){return 0<=c&&(a.dom.style.opacity=c/100,--c,50==c&&a.sticky)?(a.dom.style.opacity=.5,void(a.isDimmed=!0)):void window.setTimeout(d,b._transition/100)})()}_unDim(a){const b=this;let c=50;(function d(){if(100>c)a.dom.style.opacity=c/100,++c;else if(100==c)return a.dom.style.opacity=1,a.isDimmed=!1,void b._resetTimeout(a);window.setTimeout(d,b._transition/100)})()}new(a){if(!1===this._checkOptionsValidity(a))return-1;this._setOptionsFallback(a);let b=this._buildUI({id:this._idGenerator(`${a.type}${a.message}`,5),type:a.type,message:a.message,title:a.title,duration:a.duration,iconless:a.iconless,thickBorder:a.thickBorder,closable:a.closable,sticky:a.sticky,renderTo:a.renderTo,CBtitle:a.CBtitle,callback:a.callback,isDimmed:!1});return this._active[b.id]?(this._resetTimeout(this._active[b.id]),this._incrementRequestCounter(this._active[b.id]),b={}):this._start(b),b.id}_checkOptionsValidity(a){return void 0!==a&&void 0!==a.type&&void 0!==a.message&&""!==a.message&&!(a.sticky&&!1===a.closable&&void 0===a.callback)&&("info"!==a.type&&"success"!==a.type&&"warning"!==a.type&&"error"!==a.type&&(a.type=this._default.notification.type),this._dismissAllLock&&(this._dismissAllLock=!1),!0)}_setOptionsFallback(a){a.title===void 0&&(a.title=this._default.notification.title),a.duration===void 0&&(a.duration=this._duration),a.iconless===void 0&&(a.iconless=this._default.notification.iconless),a.thickBorder===void 0&&(a.thickBorder=this._thickBorder),a.closable===void 0&&(a.closable=this._default.notification.closable),a.sticky===void 0&&(a.sticky=this._default.notification.sticky),a.renderTo===void 0&&(a.renderTo=this._default.notification.renderTo),a.CBtitle===void 0&&(a.CBtitle=this._default.notification.CBtitle),a.callback===void 0&&(a.callback=this._default.notification.callback)}_idGenerator(a,b){let c=0,d="";if(!(0===a.length||12<b)){for(let b=0;b<a.length;++b)d=a.charCodeAt(b),c=(c<<5)-c+d,c|=0;return(Math.abs(c).toString(36)+""+Math.abs(c/2).toString(36).split("").reverse().join("")).substring(0,b).toUpperCase()}}info(a){return a.type="info",this.new(a)}success(a){return a.type="success",this.new(a)}warning(a){return a.type="warning",this.new(a)}error(a){return a.type="error",this.new(a)}dismiss(a){window.clearTimeout(this._active[a].timeoutID),1<this._active[a].requestCount&&this._clearRequestCount(this._active[a]),this._close(this._active[a])}dismissAll(){if(!this._dismissAllLock&&0!==Object.keys(this._active).length)for(const a in this._dismissAllLock=!0,this._queue={},this._active)this.dismiss(a)}dismissType(a){if(0!==Object.keys(this._active).length)for(const b in this._active)this._active[b].type===a&&this.dismiss(b)}}
